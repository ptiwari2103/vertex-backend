<%- contentFor('title') %>View Member - Vertex Admin

<%- contentFor('style') %>
<style>
    .main-content {
       padding: 20px;
    }
    .welcome-section {
        background: white;
        padding: 20px;
        border-radius: 10px;
        box-shadow: 0 0 10px rgba(0,0,0,0.1);
        margin-bottom: 20px;
    }
    .section-card {
        background: white;
        border-radius: 10px;
        box-shadow: 0 0 10px rgba(0,0,0,0.1);
        margin-bottom: 20px;
        padding: 20px;
    }
    .section-title {
        border-bottom: 2px solid #f0f0f0;
        padding-bottom: 10px;
        margin-bottom: 20px;
        color: #333;
    }
    .info-row {
        margin-bottom: 15px;
    }
    .info-label {
        font-weight: 600;
        color: #666;
    }
    .info-value {
        color: #333;
    }
    .document-image {
        max-width: 200px;
        border: 1px solid #ddd;
        border-radius: 5px;
        margin: 10px 0;
    }
    .status-badge {
        padding: 5px 10px;
        border-radius: 15px;
        font-size: 12px;
        font-weight: 500;
    }
    .status-active {
        background-color: #d4edda;
        color: #155724;
    }
    .status-pending {
        background-color: #fff3cd;
        color: #856404;
    }
    .status-inactive {
        background-color: #f8d7da;
        color: #721c24;
    }
    .form-control-static {
        padding: 0.5rem 0.75rem;
        margin-bottom: 0;
        background-color: #f3f4f6;
        border: 1px solid #d1d5db;
        border-radius: 0.375rem;
        min-height: 38px;
        display: flex;
        align-items: center;
    }
    .special-label {
    font-weight: 700;
    color: #0056b3; /* This is a blue color, you can change it to any color you prefer */
}
</style>

<%- contentFor('body') %>
<div class="main-content">
    <div class="welcome-section">
        <div class="d-flex justify-content-between align-items-center">
            <h2 class="mb-0">Member Details</h2>
            <div>
                <a href="/members/allmembers" class="btn btn-secondary me-2">
                    <i class="bx bx-arrow-back"></i> Back to List
                </a>
                <a href="/members/edit/<%= member.id %>" class="btn btn-info">
                    <i class="bx bx-edit"></i> Edit
                </a>
            </div>
        </div>
    </div>

    <!-- Basic Information -->
    <div class="section-card">
        <h4 class="section-title">Basic Information</h4>
        <div class="row">
            <div class="col-md-4">
                <div class="info-row">
                    <div class="info-label special-label">User ID</div>
                    <div class="info-value"><%= member.user_id %></div>
                </div>
                <div class="info-row">
                    <div class="info-label special-label">Account Number</div>
                    <div class="info-value"><%= member.account_number %></div>
                </div>
                <div class="info-row">
                    <div class="info-label">Name</div>
                    <div class="info-value"><%= member.name %></div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="info-row">
                    <div class="info-label">Status</div>
                    <div class="info-value">
                        <span class="status-badge <%= member.status.toLowerCase() === 'active' ? 'status-active' : 
                            member.status.toLowerCase() === 'pending' ? 'status-pending' : 'status-inactive' %>">
                            <%= member.status %>
                        </span>
                    </div>
                </div>
                <div class="info-row">
                    <div class="info-label">Is Agent</div>
                    <div class="info-value">
                        <span class="status-badge <%= member.profile.is_agent.toLowerCase() === 'active' ? 'status-active' : 
                            member.profile.is_agent.toLowerCase() === 'inactive' ? 'status-inactive' : 'status-pending' %>">
                            <%= member.profile.is_agent %>
                        </span>
                    </div>
                </div>
                <div class="info-row">
                    <div class="info-label">Is Franchise</div>
                    <div class="info-value">
                        <span class="status-badge <%= member.profile.is_fanchise.toLowerCase() === 'active' ? 'status-active' : 
                            member.profile.is_fanchise.toLowerCase() === 'inactive' ? 'status-inactive' : 'status-pending' %>">
                            <%= member.profile.is_fanchise %>
                        </span>
                    </div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="info-row">
                    <div class="info-label">Created Date</div>
                    <div class="info-value"><%= new Date(member.created_date).toLocaleDateString() %></div>
                </div>
                <div class="info-row">
                    <div class="info-label">Updated Date</div>
                    <div class="info-value"><%= new Date(member.updated_date).toLocaleDateString() %></div>
                </div>

                <div class="info-row">
                    <div class="info-label">Password</div>
                    <div class="info-value"><%= member.plain_password %></div>
                </div>
            </div>
        </div>
    </div>

    <!-- KYC Information -->
    <div class="section-card">
        <h4 class="section-title">KYC Information</h4>
        <div class="row">
            <div class="col-md-4">
                <div class="info-row">
                    <div class="info-label">KYC Status</div>
                    <div class="info-value">
                        <span class="status-badge <%= member.profile?.kyc_status?.toLowerCase() === 'approved' ? 'status-active' : 
                            member.profile?.kyc_status?.toLowerCase() === 'pending' ? 'status-pending' : 'status-inactive' %>">
                            <%= member.profile?.kyc_status || 'Not Submitted' %>
                        </span>
                    </div>
                </div>

                <div class="info-row">
                    <div class="info-label">Created Date</div>
                    <div class="info-value"><%= new Date(member.created_date).toLocaleDateString() %></div>
                </div>

                <div class="info-row">
                    <div class="info-label">Updated Date</div>
                    <div class="info-value"><%= new Date(member.updated_date).toLocaleDateString() %></div>
                </div>

                <div class="info-row">
                    <div class="info-label">PAN Number</div>
                    <div class="info-value"><%= member.profile?.pan_number || 'Not provided' %></div>
                </div>

                <div class="info-row">
                    <div class="info-label">Aadhar Number</div>
                    <div class="info-value"><%= member.profile?.aadhar_number || 'Not provided' %></div>
                </div>
            </div>
            <div class="col-md-4">
                <% if (member.profile?.aadhar_number_image_front) { %>
                    <div class="info-row">
                        <div class="info-label">Aadhar Front Image</div>
                        <img src="/<%= member.profile.aadhar_number_image_front %>" class="document-image" alt="Aadhar Front">
                    </div>
                <% } %>
                <% if (member.profile?.aadhar_number_image_back) { %>
                    <div class="info-row">
                        <div class="info-label">Aadhar Back Image</div>
                        <img src="/<%= member.profile.aadhar_number_image_back %>" class="document-image" alt="Aadhar Back">
                    </div>
                <% } %>
            </div>

            <div class="col-md-4">
                <% if (member.profile?.pan_number_image) { %>
                    <div class="info-row">
                        <div class="info-label">PAN Card Image</div>
                        <img src="/<%= member.profile.pan_number_image %>" class="document-image" alt="PAN Card">
                    </div>
                <% } %>                
            </div>
        </div>
    </div>

    <!-- Profile Information -->
    <div class="section-card">
        <h4 class="section-title">Profile Information</h4>
        <div class="row">
            <div class="col-md-4">
                <div class="info-row">
                    <div class="info-label">Created Date</div>
                    <div class="info-value"><%= new Date(member.created_date).toLocaleDateString() %></div>
                </div>

                <div class="info-row">
                    <div class="info-label">Updated Date</div>
                    <div class="info-value"><%= new Date(member.updated_date).toLocaleDateString() %></div>
                </div>

                <div class="info-row">
                    <div class="info-label">Email ID</div>
                    <div class="info-value"><%= member.email_id || 'Not provided' %></div>
                </div>
                <div class="info-row">
                    <div class="info-label">Mobile Number</div>
                    <div class="info-value"><%= member.mobile_number || 'Not provided' %></div>
                </div>
                <div class="info-row">
                    <div class="info-label">Gender</div>
                    <div class="info-value"><%= member.gender || 'Not provided' %></div>
                </div>
                <div class="info-row">
                    <div class="info-label">Date of Birth</div>
                    <div class="info-value"><%= member.date_of_birth ? new Date(member.date_of_birth).toLocaleDateString() : 'Not provided' %></div>
                </div>
                <% if (member.profile?.profile_image) { %>
                    <div class="info-row">
                        <div class="info-label">Profile Image</div>
                        <div class="info-value">
                            <img src="/<%= member.profile.profile_image %>" class="profile-image" alt="Profile Image" style="max-width: 150px; border-radius: 5px;">
                        </div>
                    </div>
                <% } %>
                <div class="info-row">
                    <div class="info-label">Guardian Name</div>
                    <div class="info-value"><%= member.guardian_name || 'Not provided' %></div>
                </div>
                <div class="info-row">
                    <div class="info-label">Guardian Relation</div>
                    <div class="info-value"><%= member.guardian_relation || 'Not provided' %></div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="info-row">
                    <div class="info-label">Nominee Name</div>
                    <div class="info-value"><%= member.profile?.nominee_name || 'Not provided' %></div>
                </div>
                <div class="info-row">
                    <div class="info-label">Nominee Relation</div>
                    <div class="info-value"><%= member.profile?.nominee_relation || 'Not provided' %></div>
                </div>
                <div class="info-row">
                    <div class="info-label">Nominee Contact</div>
                    <div class="info-value"><%= member.profile?.nominee_contact || 'Not provided' %></div>
                </div>
                <div class="info-row">
                    <div class="info-label">Nominee Email</div>
                    <div class="info-value"><%= member.profile?.nominee_email || 'Not provided' %></div>
                </div>
            </div>
            <div class="col-md-4">
                <div class="info-row">
                    <div class="info-label">Senior Citizen</div>
                    <div class="info-value">
                        <span class="status-badge <%= member.profile?.is_senior_citizen ? 'status-active' : 'status-inactive' %>">
                            <%= member.profile?.is_senior_citizen ? 'Yes' : 'No' %>
                        </span>
                    </div>
                </div>
                <div class="info-row">
                    <div class="info-label">Divyang Status</div>
                    <div class="info-value">
                        <span class="status-badge <%= member.profile?.is_divyang ? 'status-active' : 'status-inactive' %>">
                            <%= member.profile?.is_divyang ? 'Yes' : 'No' %>
                        </span>
                    </div>
                </div>
                <% if (member.profile?.is_divyang) { %>
                    <div class="info-row">
                        <div class="info-label">Divyang Type</div>
                        <div class="info-value"><%= member.profile?.divyang_type || 'Not specified' %></div>
                    </div>
                    <div class="info-row">
                        <div class="info-label">Divyang Percentage</div>
                        <div class="info-value"><%= member.profile?.divyang_percentage %></div>
                    </div>
                    <% if (member.profile?.divyang_certificate) { %>
                        <div class="info-row">
                            <div class="info-label">Divyang Certificate</div>
                            <div class="info-value">
                                <img src="/<%= member.profile.divyang_certificate %>" class="document-image" alt="Divyang Certificate">
                            </div>
                        </div>
                    <% } %>
                <% } %>
            </div>
        </div>
    </div>

    <!-- Address Information -->
    <div class="section-card">
        <h4 class="section-title">Address Information</h4>
        <div id="addressList">
            <% member.userAddress.forEach((address, index) => { %>
                <div class="address-item mb-4 border rounded p-3">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h5 class="mb-0">Address #<%= index + 1 %></h5>
                        <span>Created Date: <%= new Date(address.created_date).toLocaleDateString() %> </span>
                        <span>Updated Date: <%= new Date(address.updated_date).toLocaleDateString() %> </span>
                        <span class="badge <%= address.status === 'Active' ? 'bg-success' : 'bg-secondary' %>">
                            <%= address.status %>
                        </span>
                    </div>
                    <div class="row g-3">
                        <div class="col-md-6">
                            <h6>Permanent Address</h6>
                            <div class="mb-3">
                                <label class="form-label">Address</label>
                                <p class="form-control-static"><%= address.permanent_address %></p>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">City</label>
                                <p class="form-control-static"><%= address.permanent_city %></p>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">State</label>
                                <p class="form-control-static"><%= address.permanentState.name %></p>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">District</label>
                                <p class="form-control-static"><%= address.permanentDistrict.name %></p>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Pincode</label>
                                <p class="form-control-static"><%= address.permanent_pincode %></p>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <h6>Correspondence Address</h6>
                            <div class="mb-3">
                                <label class="form-label">Address</label>
                                <p class="form-control-static"><%= address.correspondence_address %></p>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">City</label>
                                <p class="form-control-static"><%= address.correspondence_city %></p>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">State</label>
                                <p class="form-control-static"><%= address.correspondenceState.name %></p>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">District</label>
                                <p class="form-control-static"><%= address.correspondenceDistrict.name %></p>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Pincode</label>
                                <p class="form-control-static"><%= address.correspondence_pincode %></p>
                            </div>
                        </div>
                    </div>
                </div>
            <% }); %>
        </div>
    </div>

    <!-- Bank Information -->
    <div class="section-card">
        <h4 class="section-title">Bank Information</h4>
        <div id="bankList">
            <% member.userBank.forEach((bank, index) => { %>
                <div class="bank-item mb-4 border rounded p-3">
                    <div class="d-flex justify-content-between align-items-center mb-3">
                        <h5 class="mb-0">Bank Account #<%= index + 1 %></h5>
                        <span>Created Date: <%= new Date(bank.created_date).toLocaleDateString() %> </span>
                        <span>Updated Date: <%= new Date(bank.updated_date).toLocaleDateString() %> </span>
                        
                        <span class="badge <%= bank.status === 'Active' ? 'bg-success' : 'bg-secondary' %>">
                            <%= bank.status %>
                        </span>
                    </div>
                    <div class="row g-3">
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">Bank Name</label>
                                <p class="form-control-static"><%= bank.bank_name %></p>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Branch Name</label>
                                <p class="form-control-static"><%= bank.branch_name %></p>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Account Number</label>
                                <p class="form-control-static"><%= bank.account_number %></p>
                            </div>
                        </div>
                        <div class="col-md-6">
                            <div class="mb-3">
                                <label class="form-label">IFSC Number</label>
                                <p class="form-control-static"><%= bank.ifsc_number %></p>
                            </div>
                            <div class="mb-3">
                                <label class="form-label">Account Type</label>
                                <p class="form-control-static"><%= bank.account_type %></p>
                            </div>
                        </div>
                    </div>
                </div>
            <% }); %>
        </div>
    </div>


    <!-- Referral Information -->
    <div class="section-card">
        <h4 class="section-title">Member Fees Information</h4>
        <div id="referralList">
            <% if (member.userReferralMoney) { %>
                <% const referral = member.userReferralMoney; %>
                <div class="row mb-3">
                    <div class="col-12 mb-2">
                        <div class="d-flex align-items-center">
                            <span class="me-2 fw-bold">Pay Key:</span>
                            <span><%= referral.pay_key %></span>
                        </div>
                    </div>
                </div>

                <!-- Refundable Section -->
                <div class="card mb-4">
                    <div class="card-header bg-light text-primary" style="border-top: 3px solid #0d6efd;">
                        <h5 class="mb-0">Refundable Deposits</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <div class="d-flex">
                                    <span class="fw-bold me-2">Shared Money:</span>
                                    <span>₹ <%= referral.shared_money.toFixed(2) %></span>
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <div class="d-flex">
                                    <span class="fw-bold me-2">Compulsory Deposit:</span>
                                    <span>₹ <%= referral.compulsory_deposit.toFixed(2) %></span>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-12">
                                <div class="d-flex">
                                    <span class="fw-bold me-2">Refundable Subtotal:</span>
                                    <span>₹ <%= (referral.shared_money + referral.compulsory_deposit).toFixed(2) %></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Non-Refundable Section -->
                <div class="card mb-4">
                    <div class="card-header bg-light text-info" style="border-top: 3px solid #0dcaf0;">
                        <h5 class="mb-0">Non-Refundable Fees</h5>
                    </div>
                    <div class="card-body">
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <div class="d-flex">
                                    <span class="fw-bold me-2">Admission Fee:</span>
                                    <span>₹ <%= referral.admission_fee.toFixed(2) %></span>
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <div class="d-flex">
                                    <span class="fw-bold me-2">Building Fund:</span>
                                    <span>₹ <%= referral.building_fund.toFixed(2) %></span>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-md-6 mb-3">
                                <div class="d-flex">
                                    <span class="fw-bold me-2">Welfare Fund:</span>
                                    <span>₹ <%= referral.welfare_fund.toFixed(2) %></span>
                                </div>
                            </div>
                            <div class="col-md-6 mb-3">
                                <div class="d-flex">
                                    <span class="fw-bold me-2">Other Deposit:</span>
                                    <span>₹ <%= referral.other_deposit.toFixed(2) %></span>
                                </div>
                            </div>
                        </div>
                        <div class="row">
                            <div class="col-12">
                                <div class="d-flex">
                                    <span class="fw-bold me-2">Non-Refundable Subtotal:</span>
                                    <span>₹ <%= (referral.admission_fee + referral.building_fund + referral.welfare_fund + referral.other_deposit).toFixed(2) %></span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Total Section -->
                <div class="card">
                    <div class="card-body bg-light">
                        <div class="d-flex">
                            <span class="fw-bold me-2">Total Amount:</span>
                            <span class="fw-bold">₹ <%= (referral.shared_money + referral.compulsory_deposit + referral.admission_fee + referral.building_fund + referral.welfare_fund + referral.other_deposit).toFixed(2) %></span>
                        </div>
                    </div>
                </div>
            <% } else { %>
                <div class="alert alert-info">
                    No referral information available for this member.
                </div>
            <% } %>
        </div>
    </div>
    
</div>